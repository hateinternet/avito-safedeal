{"version":3,"sources":["components/error-indicator/error.svg","components/img/loading.svg","components/img/error.svg","service.js","components/spinner/index.js","components/spinner/spinner.js","components/error-indicator/index.js","components/error-indicator/error-indicator.js","components/img/index.js","components/img/img.js","components/input/index.js","components/input/input.js","utils/generateId.js","utils/transformDate.js","components/gallery-modal/index.js","components/gallery-modal/gallery-modal.js","components/gallery/index.js","components/gallery/gallery.js","components/app/index.js","components/app/app.js","index.js"],"names":["module","exports","GalleryService","_apiBase","url","fetch","this","res","ok","Error","status","json","body","getResource","id","comment","method","headers","JSON","stringify","Promise","resolve","Spinner","className","ErrorIndicator","src","image","alt","href","Img","state","source","error","loadImage","reject","Image","onload","onerror","props","then","setState","catch","imgError","imgLoading","React","Component","Input","name","value","onChange","placeholder","errorText","isValid","cls","cn","length","placeholderText","type","Math","random","toString","substr","timestamp","Date","toLocaleDateString","GalleryModal","galleryService","buttonRef","createRef","loading","comments","text","nameIsValid","textIsValid","submitBlocked","keyDownModal","key","closeModal","submitForm","evt","preventDefault","validateForm","postComment","modalIdx","newComment","generateId","date","now","concat","current","blur","changeInput","target","renderComments","map","transformDate","renderModalContent","onSubmit","ref","onClick","getImage","document","addEventListener","removeEventListener","nameIsEmpty","trim","textIsEmpty","modalContent","Gallery","images","modalOpened","openModal","classList","add","remove","keyDownGallery","renderImages","onKeyDown","tabIndex","renderModal","getAllImages","modal","App","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.fb0a7bec.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/error.887a5f02.svg\";","module.exports = __webpack_public_path__ + \"static/media/loading.85364106.svg\";","module.exports = __webpack_public_path__ + \"static/media/error.0edf97f1.svg\";","export default class GalleryService {\n  _apiBase = 'https://boiling-refuge-66454.herokuapp.com';\n\n  async getResource(url) {\n    const res = await fetch(`${this._apiBase}${url}`);\n\n    if (!res.ok) {\n      throw new Error(`Could not fetch ${url}, recieved ${res.status}`);\n    }\n\n    const body = await res.json();\n    return body;\n  }\n\n  async getAllImages() {\n    const res = await this.getResource('/images');\n    return await res;\n  }\n\n  async getImage(id) {\n    const res = await this.getResource(`/images/${id}`);\n    return await res;\n  }\n\n  async postComment(id, comment) {\n    const res = await fetch(`${this._apiBase}/images/${id}/comments`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json;charset=utf-8',\n      },\n      body: JSON.stringify(comment),\n    });\n\n    if (res.status !== 204) {\n      throw new Error(`Could not fetch, recieved ${res.status}`);\n    }\n\n    return Promise.resolve();\n  }\n}\n","import Spinner from './spinner';\n\nexport default Spinner;\n","import React from 'react';\n\nimport './spinner.css';\n\nconst Spinner = () => {\n  return (\n    <div className=\"spinner\">\n      <div className=\"spinner__inner\" />\n    </div>\n  );\n};\n\nexport default Spinner;\n","import ErrorIndicator from './error-indicator';\n\nexport default ErrorIndicator;\n","import React from 'react';\n\nimport image from './error.svg';\nimport './error-indicator.css';\n\nconst ErrorIndicator = () => {\n  return (\n    <div className=\"error\">\n      <img className=\"error__image\" src={image} alt=\"error\" />\n      <span className=\"error__text\">something has gone terribly wrong</span>\n      <a className=\"error__link\" href=\"/\">try starting over</a>\n    </div>\n  );\n};\n\nexport default ErrorIndicator;\n","import Img from './img';\n\nexport default Img;\n","import React from 'react';\n\nimport imgLoading from './loading.svg';\nimport imgError from './error.svg';\nimport './img.css';\n\nexport default class Img extends React.Component {\n  state = {\n    source: null,\n    error: false,\n  };\n\n  loadImage = (url) => {\n    return new Promise((resolve, reject) => {\n      const image = new Image();\n      image.src = url;\n      image.onload = resolve;\n      image.onerror = reject;\n    });\n  };\n\n  componentDidMount() {\n    const { src } = this.props;\n    this.loadImage(this.props.src)\n      .then(() => {\n        this.setState({ source: src });\n      })\n      .catch(() => {\n        this.setState({ error: true });\n      });\n  }\n\n  render() {\n    const { className, alt } = this.props;\n    const { source, error } = this.state;\n\n    if (error) {\n      return <img src={imgError} className=\"img\" alt=\"\" />;\n    }\n\n    if (!source) {\n      return <img src={imgLoading} className=\"img\" alt=\"\"/>;\n    }\n\n    return <img src={source} className={className} alt={alt} />;\n  }\n}\n","import Input from './input';\n\nexport default Input;\n","import React from 'react';\nimport cn from 'classnames';\n\nimport './input.css';\n\nconst Input = ({name, value, onChange, placeholder, errorText = 'Заполните поле', isValid = true }) => {\n  const cls = cn({\n    'input': true,\n    'input_filled': value.length > 0,\n    'input_error': !isValid,\n  });\n  const placeholderText = isValid ? placeholder : errorText;\n\n  return (\n    <div className={cls}>\n      <input className=\"input__field\" type=\"text\" name={name} value={value} onChange={onChange}/>\n      <div className=\"input__placeholder\">{placeholderText}</div>\n    </div>\n  );\n};\n\nexport default Input;\n","export default () => Math.random().toString(32).substr(2, 12);\n","export default (timestamp) => {\n  const date = new Date(timestamp);\n  return date.toLocaleDateString();\n};\n","import GalleryModal from './gallery-modal';\n\nexport default GalleryModal;\n","import React from 'react';\nimport FocusLock from \"react-focus-lock\";\n\nimport GalleryService from '../../service';\nimport Img from '../img';\nimport Spinner from '../spinner';\nimport ErrorIndicator from '../error-indicator';\nimport Input from '../input';\nimport { generateId, transformDate } from '../../utils';\nimport './gallery-modal.css';\n\nexport default class GalleryModal extends React.Component {\n  galleryService = new GalleryService();\n  buttonRef = React.createRef();\n\n  state = {\n    loading: true,\n    error: false,\n    url: '',\n    comments: [],\n    name: '',\n    text: '',\n    nameIsValid: true,\n    textIsValid: true,\n    submitBlocked: false,\n  };\n\n  componentDidMount() {\n    this.galleryService\n      .getImage(this.props.modalIdx)\n      .then(({ url, comments }) => {\n        this.setState({\n          url,\n          comments,\n          loading: false,\n        });\n      })\n      .catch(() => {\n        this.setState({\n          error: true,\n          loading: false,\n        });\n      });\n\n    // не нашел адекватного пути вешать обработку клавиши Escape :(\n    // если вешать onKeyDown на .gallery-modal - Escape не срабатывает, т.к. фокус уходит на body\n    // и приходится минимум 1 раз нажать tab для фокусировки внутри модалки\n    document.body.addEventListener('keydown', this.keyDownModal);\n  }\n\n  componentWillUnmount() {\n    document.body.removeEventListener('keydown', this.keyDownModal);\n  }\n\n  keyDownModal = ({ key }) => {\n    key === 'Escape' && this.props.closeModal();\n  };\n\n  validateForm() {\n    const { name, text } = this.state;\n    const nameIsEmpty = name.trim().length === 0;\n    const textIsEmpty = text.trim().length === 0;\n\n    this.setState({\n      nameIsValid: !nameIsEmpty,\n      textIsValid: !textIsEmpty,\n    });\n\n    if (nameIsEmpty || textIsEmpty) {\n      return false;\n    }\n\n    return true;\n  }\n\n  submitForm = (evt) => {\n    evt.preventDefault();\n\n    const formIsValid = this.validateForm();\n    if (!formIsValid) {\n      return ;\n    }\n\n    const { submitBlocked } = this.state;\n    if (submitBlocked) {\n      return ;\n    }\n\n    const { text, name } = this.state;\n    this.setState({ submitBlocked: true });\n    this.galleryService\n      .postComment(this.props.modalIdx, {name, comment: text})\n      .then(() => {\n        const { comments } = this.state;\n        const newComment = {\n          text,\n          id: generateId(),\n          date: Date.now(),\n        };\n\n        this.setState({\n          name: '',\n          text: '',\n          nameIsValid: true,\n          textIsValid: true,\n          comments: comments.concat(newComment),\n          submitBlocked: false,\n        });\n      });\n\n    this.buttonRef.current.blur();\n  };\n\n  changeInput = (evt) => {\n    this.setState({ [evt.target.name]: evt.target.value });\n  };\n\n  renderComments = () => {\n    const { comments } = this.state;\n\n    if (comments.length === 0) {\n      return (\n        <div className=\"gallery-modal__comments-dummy\">\n          Здесь пока никто не написал... :(\n          <br />\n          Оставьте первый комментарий!\n        </div>\n      );\n    }\n\n    const renderedComments = comments.map(comment => {\n      const { id, date, text } = comment;\n      return (\n        <div key={id} className=\"gallery-modal__comment\">\n          <time className=\"gallery-modal__comment-date\">{transformDate(date)}</time>\n          <p className=\"gallery-modal__comment-text\">{text}</p>\n        </div>\n      );\n    });\n\n    return renderedComments;\n  };\n\n  renderModalContent = () => {\n    if (this.state.loading) {\n      return <Spinner />;\n    }\n\n    if (this.state.error) {\n      return <ErrorIndicator />;\n    }\n\n    const { closeModal } = this.props;\n    const { url, name, text, nameIsValid, textIsValid } = this.state;\n    const comments = this.renderComments();\n\n    return (\n      <>\n        <div className=\"gallery-modal__image-container\">\n          <Img src={url} className=\"gallery-modal__image\" alt=\"\" />\n        </div>\n        <div className=\"gallery-modal__comments\">{comments}</div>\n        <form className=\"gallery-modal__form\" onSubmit={this.submitForm}>\n          <div className=\"gallery-modal__input\">\n            <Input name=\"name\"\n              value={name}\n              onChange={this.changeInput}\n              placeholder=\"Ваше имя\"\n              errorText=\"Введите ваше имя\"\n              isValid={nameIsValid} />\n          </div>\n          <div className=\"gallery-modal__input\">\n            <Input name=\"text\"\n              value={text}\n              onChange={this.changeInput}\n              placeholder=\"Ваш комментарий\"\n              errorText=\"Введите комментарий\"\n              isValid={textIsValid} />\n          </div>\n          <button className=\"gallery-modal__button\" ref={this.buttonRef}>Оставить комментарий</button>\n        <button className=\"gallery-modal__close\" onClick={closeModal}/>\n        </form>\n      </>\n    );\n  };\n\n  render() {\n    const { closeModal } = this.props;\n    const modalContent = this.renderModalContent();\n\n    return (\n      <FocusLock>\n        <div className=\"gallery-modal\">\n          <div className=\"gallery-modal__paranja\" onClick={closeModal}/>\n          <div className=\"gallery-modal__content\">\n            { modalContent }\n          </div>\n        </div>\n      </FocusLock>\n    );\n  }\n}\n","import Gallery from './gallery';\n\nexport default Gallery;\n","import React from 'react';\n\nimport GalleryService from '../../service';\nimport Spinner from '../spinner';\nimport ErrorIndicator from '../error-indicator';\nimport Img from '../img';\nimport GalleryModal from '../gallery-modal';\nimport './gallery.css';\n\nexport default class Gallery extends React.Component {\n\n  galleryService = new GalleryService();\n\n  state = {\n    loading: true,\n    error: false,\n    images: null,\n    modalOpened: false,\n    modalIdx: null,\n    name: '',\n    text: '',\n  };\n\n  componentDidMount() {\n    this.galleryService.getAllImages()\n      .then(images => {\n        this.setState({ loading: false, images });\n      })\n      .catch(() => {\n        this.setState({ loading: false, error: true });\n      });\n  }\n\n  openModal = (id) => {\n    document.body.classList.add('scroll-hidden');\n    this.setState({ modalOpened: true, modalIdx: id });\n  };\n\n  closeModal = () => {\n    document.body.classList.remove('scroll-hidden');\n    this.setState({ modalOpened: false, modalIdx: null });\n  };\n\n  keyDownGallery = (evt, id) => {\n    if (evt.key === 'Enter') {\n      this.openModal(id);\n      evt.target.blur();\n    }\n  };\n\n  renderImages = () => this.state.images.map(({ id, url }) => (\n    <div\n      key={id}\n      className=\"gallery-item\"\n      onClick={() => this.openModal(id)}\n      onKeyDown={(evt) => this.keyDownGallery(evt, id)}\n      tabIndex=\"0\">\n      <Img src={url} className=\"gallery-item__img\" alt=\"\" />\n    </div>\n  ));\n\n  renderModal = () => {\n    const { modalOpened, modalIdx } = this.state;\n\n    if (!modalOpened) {\n      return null;\n    }\n\n    return <GalleryModal modalIdx={modalIdx} closeModal={this.closeModal}/>;\n  }\n\n  render() {\n    if (this.state.loading) {\n      return <Spinner />;\n    }\n\n    if (this.state.error) {\n      return <ErrorIndicator />;\n    }\n\n    const images = this.renderImages();\n    const modal = this.renderModal();\n\n    return (\n      <div className=\"gallery\">\n        { images }\n        { modal }\n      </div>\n    );\n  }\n}\n","import App from './app';\n\nexport default App;\n","import React from 'react';\n\nimport Gallery from '../gallery';\nimport './app.css';\n\nexport default class App extends React.Component {\n\n  render() {\n    return (\n      <section className=\"app\">\n\n        <header className=\"app__header\">\n          <h1 className=\"app__title\">Test App</h1>\n        </header>\n\n        <div className=\"app__main\">\n          <Gallery />\n        </div>\n\n        <footer className=\"app__footer\">\n          <span className=\"app__copyright\">\n            &copy; 2018-2019\n          </span>\n        </footer>\n\n      </section>\n    );\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './normalize.css';\nimport './style.css';\n\nimport App from './components/app';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}