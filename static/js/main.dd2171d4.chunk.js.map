{"version":3,"sources":["components/error-indicator/error.svg","components/img/loading.svg","components/img/error.svg","service.js","components/spinner/index.js","components/spinner/spinner.js","components/error-indicator/index.js","components/error-indicator/error-indicator.js","components/img/index.js","components/img/img.js","components/input/index.js","components/input/input.js","utils/generateId.js","utils/transformDate.js","components/gallery-modal/index.js","components/gallery-modal/gallery-modal.js","components/gallery/index.js","components/gallery/gallery.js","components/app/index.js","components/app/app.js","index.js"],"names":["module","exports","GalleryService","_apiBase","url","fetch","this","res","ok","Error","status","json","body","getResource","id","comment","method","headers","JSON","stringify","Promise","resolve","Spinner","className","ErrorIndicator","src","image","alt","href","Img","state","source","error","loadImage","reject","Image","onload","onerror","props","then","setState","catch","imgError","imgLoading","React","Component","Input","name","value","onChange","placeholder","errorText","isValid","cls","cn","length","placeholderText","type","Math","random","toString","substr","timestamp","Date","toISOString","replace","GalleryModal","galleryService","buttonRef","createRef","loading","comments","text","nameIsValid","textIsValid","submitBlocked","keyDownModal","key","closeModal","submitForm","evt","preventDefault","validateForm","trim","postComment","modalIdx","newComment","generateId","date","now","concat","current","blur","changeInput","target","renderComments","map","transformDate","renderModalContent","onSubmit","ref","onClick","getImage","document","addEventListener","removeEventListener","nameIsEmpty","textIsEmpty","modalContent","Gallery","images","modalOpened","openModal","classList","add","remove","keyDownGallery","renderImages","onKeyDown","tabIndex","renderModal","getAllImages","modal","App","ReactDOM","render","getElementById"],"mappings":"8FAAAA,EAAOC,QAAU,IAA0B,mC,gBCA3CD,EAAOC,QAAU,IAA0B,qC,gBCA3CD,EAAOC,QAAU,IAA0B,mC,wVCAtBC,E,iDACnBC,SAAW,6C,wDAEOC,G,oGACEC,MAAM,GAAD,OAAIC,KAAKH,UAAT,OAAoBC,K,WAArCG,E,QAEGC,G,sBACD,IAAIC,MAAJ,0BAA6BL,EAA7B,sBAA8CG,EAAIG,S,iCAGvCH,EAAII,Q,cAAjBC,E,yBACCA,G,wLAIWN,KAAKO,YAAY,Y,cAA7BN,E,0BACOA,G,wHAGAO,G,kGACKR,KAAKO,YAAL,kBAA4BC,K,cAAxCP,E,0BACOA,G,2HAGGO,EAAIC,G,kGACFV,MAAM,GAAD,OAAIC,KAAKH,SAAT,mBAA4BW,EAA5B,aAA2C,CAChEE,OAAQ,OACRC,QAAS,CACP,eAAgB,kCAElBL,KAAMM,KAAKC,UAAUJ,M,UAGJ,OARbR,E,QAQEG,O,sBACA,IAAID,MAAJ,oCAAuCF,EAAIG,S,gCAG5CU,QAAQC,W,wDCnCJC,G,MCEC,WACd,OACE,yBAAKC,UAAU,WACb,yBAAKA,UAAU,sB,iBCLNC,G,MCGQ,WACrB,OACE,yBAAKD,UAAU,SACb,yBAAKA,UAAU,eAAeE,IAAKC,IAAOC,IAAI,UAC9C,0BAAMJ,UAAU,eAAhB,qCACA,uBAAGA,UAAU,cAAcK,KAAK,KAAhC,wB,kCCRSC,G,iNCKbC,MAAQ,CACNC,OAAQ,KACRC,OAAO,G,EAGTC,UAAY,SAAC7B,GACX,OAAO,IAAIgB,SAAQ,SAACC,EAASa,GAC3B,IAAMR,EAAQ,IAAIS,MAClBT,EAAMU,OAASf,EACfK,EAAMW,QAAUH,EAChBR,EAAMD,IAAMrB,M,mFAIK,IAAD,OACVqB,EAAQnB,KAAKgC,MAAbb,IACRnB,KAAK2B,UAAU3B,KAAKgC,MAAMb,KACvBc,MAAK,WACJ,EAAKC,SAAS,CAAET,OAAQN,OAEzBgB,OAAM,WACL,EAAKD,SAAS,CAAER,OAAO,S,+BAInB,IAAD,EACoB1B,KAAKgC,MAAxBf,EADD,EACCA,UAAWI,EADZ,EACYA,IADZ,EAEmBrB,KAAKwB,MAAvBC,EAFD,EAECA,OAER,OAJO,EAESC,MAIZ,yBAAKT,UAAU,OACb,yBAAKA,UAAU,aAAaI,IAAI,GAAGF,IAAKiB,OAKzCX,EAQE,yBAAKN,IAAKM,EAAQR,UAAWA,EAAWI,IAAKA,IANhD,yBAAKJ,UAAU,OACb,yBAAKA,UAAU,aAAaI,IAAI,GAAGF,IAAKkB,W,GAzCjBC,IAAMC,Y,gCCJxBC,G,MCGD,SAAC,GAAyF,IAAxFC,EAAuF,EAAvFA,KAAMC,EAAiF,EAAjFA,MAAOC,EAA0E,EAA1EA,SAAUC,EAAgE,EAAhEA,YAAgE,IAAnDC,iBAAmD,MAAvC,kFAAuC,MAArBC,eAAqB,SAC/FC,EAAMC,IAAG,CACb,OAAS,EACT,aAAgBN,EAAMO,OAAS,EAC/B,aAAgBH,IAEZI,EAAkBJ,EAAUF,EAAcC,EAEhD,OACE,yBAAK5B,UAAW8B,GACd,2BAAO9B,UAAU,eAAekC,KAAK,OAAOV,KAAMA,EAAMC,MAAOA,EAAOC,SAAUA,IAChF,yBAAK1B,UAAU,sBAAsBiC,MChB5B,oBAAME,KAAKC,SAASC,SAAS,IAAIC,OAAO,EAAG,KCA3C,WAACC,GACd,OAAO,IAAIC,KAAKD,GAAWE,cACxBC,QAAQ,iBAAiB,MACzBA,QAAQ,sBAAsB,aCDpBC,G,iNCUbC,eAAiB,IAAIjE,E,EACrBkE,UAAYxB,IAAMyB,Y,EAElBvC,MAAQ,CACNwC,SAAS,EACTtC,OAAO,EACP5B,IAAK,GACLmE,SAAU,GACVxB,KAAM,GACNyB,KAAM,GACNC,aAAa,EACbC,aAAa,EACbC,eAAe,G,EA8BjBC,aAAe,YACL,WADkB,EAAVC,KACI,EAAKvC,MAAMwC,c,EAoBjCC,WAAa,SAACC,GAIZ,IAHAA,EAAIC,iBAEgB,EAAKC,kBAKC,EAAKpD,MAAvB6C,cACR,CAIA,IAAMH,EAAO,EAAK1C,MAAM0C,KAAKW,OACvBpC,EAAO,EAAKjB,MAAMiB,KAAKoC,OAC7B,EAAK3C,SAAS,CAAEmC,eAAe,IAC/B,EAAKR,eACFiB,YAAY,EAAK9C,MAAM+C,SAAU,CAAEtC,OAAMhC,QAASyD,IAClDjC,MAAK,WAAO,IACHgC,EAAa,EAAKzC,MAAlByC,SACFe,EAAa,CACjBd,OACAzB,OACAjC,GAAIyE,IACJC,KAAMzB,KAAK0B,OAGb,EAAKjD,SAAS,CACZO,KAAM,GACNyB,KAAM,GACNC,aAAa,EACbC,aAAa,EACbH,SAAUA,EAASmB,OAAOJ,GAC1BX,eAAe,OAIrB,EAAKP,UAAUuB,QAAQC,S,EAGzBC,YAAc,SAACb,GACb,EAAKxC,SAAL,eAAiBwC,EAAIc,OAAO/C,KAAOiC,EAAIc,OAAO9C,S,EAGhD+C,eAAiB,WAAO,IACdxB,EAAa,EAAKzC,MAAlByC,SAER,OAAwB,IAApBA,EAAShB,OAET,yBAAKhC,UAAU,iCAAf,uJAEE,6BAFF,6JAQqBgD,EAASyB,KAAI,SAAAjF,GAAY,IACxCD,EAAyBC,EAAzBD,GAAI0E,EAAqBzE,EAArByE,KAAMhB,EAAezD,EAAfyD,KAAMzB,EAAShC,EAATgC,KACxB,OACE,yBAAK8B,IAAK/D,EAAIS,UAAU,0BACtB,yBAAKA,UAAU,+BACb,0BAAMA,UAAU,+BAA+B0E,EAAcT,IAC7D,0BAAMjE,UAAU,+BAA+BwB,GAAQ,SAEzD,uBAAGxB,UAAU,+BAA+BiD,Q,EAQpD0B,mBAAqB,WACnB,GAAI,EAAKpE,MAAMwC,QACb,OAAO,kBAAC,EAAD,MAGT,GAAI,EAAKxC,MAAME,MACb,OAAO,kBAAC,EAAD,MANgB,IASjB8C,EAAe,EAAKxC,MAApBwC,WATiB,EAU6B,EAAKhD,MAAnD1B,EAViB,EAUjBA,IAAK2C,EAVY,EAUZA,KAAMyB,EAVM,EAUNA,KAAMC,EAVA,EAUAA,YAAaC,EAVb,EAUaA,YAChCH,EAAW,EAAKwB,iBAEtB,OACE,oCACE,yBAAKxE,UAAU,kCACb,kBAAC,EAAD,CAAKE,IAAKrB,EAAKmB,UAAU,uBAAuBI,IAAI,MAEtD,yBAAKJ,UAAU,2BAA2BgD,GAC1C,0BAAMhD,UAAU,sBAAsB4E,SAAU,EAAKpB,YACnD,yBAAKxD,UAAU,wBACb,kBAAC,EAAD,CAAOwB,KAAK,OACVC,MAAOD,EACPE,SAAU,EAAK4C,YACf3C,YAAY,8CACZC,UAAU,yFACVC,QAASqB,KAEb,yBAAKlD,UAAU,wBACb,kBAAC,EAAD,CAAOwB,KAAK,OACVC,MAAOwB,EACPvB,SAAU,EAAK4C,YACf3C,YAAY,wFACZC,UAAU,gHACVC,QAASsB,KAEb,4BAAQnD,UAAU,wBAAwB6E,IAAK,EAAKhC,WAApD,uHACF,4BAAQ7C,UAAU,uBAAuB8E,QAASvB,O,mFA9JnC,IAAD,OAClBxE,KAAK6D,eACFmC,SAAShG,KAAKgC,MAAM+C,UACpB9C,MAAK,YAAwB,IAArBnC,EAAoB,EAApBA,IAAKmE,EAAe,EAAfA,SACZ,EAAK/B,SAAS,CACZpC,MACAmE,WACAD,SAAS,OAGZ7B,OAAM,WACL,EAAKD,SAAS,CACZR,OAAO,EACPsC,SAAS,OAOfiC,SAAS3F,KAAK4F,iBAAiB,UAAWlG,KAAKsE,gB,6CAI/C2B,SAAS3F,KAAK6F,oBAAoB,UAAWnG,KAAKsE,gB,qCAOpC,IAAD,EACUtE,KAAKwB,MAApBiB,EADK,EACLA,KAAMyB,EADD,EACCA,KACRkC,EAAqC,IAAvB3D,EAAKoC,OAAO5B,OAC1BoD,EAAqC,IAAvBnC,EAAKW,OAAO5B,OAOhC,OALAjD,KAAKkC,SAAS,CACZiC,aAAciC,EACdhC,aAAciC,KAGZD,IAAeC,I,+BA2HX,IACA7B,EAAexE,KAAKgC,MAApBwC,WACF8B,EAAetG,KAAK4F,qBAE1B,OACE,kBAAC,IAAD,KACE,yBAAK3E,UAAU,iBACb,yBAAKA,UAAU,yBAAyB8E,QAASvB,IACjD,yBAAKvD,UAAU,0BACXqF,S,GA7L4BhE,IAAMC,YCTjCgE,G,iNCSb1C,eAAiB,IAAIjE,E,EAErB4B,MAAQ,CACNwC,SAAS,EACTtC,OAAO,EACP8E,OAAQ,KACRC,aAAa,EACb1B,SAAU,KACVtC,KAAM,GACNyB,KAAM,I,EAaRwC,UAAY,SAAClG,GACXyF,SAAS3F,KAAKqG,UAAUC,IAAI,iBAC5B,EAAK1E,SAAS,CAAEuE,aAAa,EAAM1B,SAAUvE,K,EAG/CgE,WAAa,WACXyB,SAAS3F,KAAKqG,UAAUE,OAAO,iBAC/B,EAAK3E,SAAS,CAAEuE,aAAa,EAAO1B,SAAU,Q,EAGhD+B,eAAiB,SAACpC,EAAKlE,GACL,UAAZkE,EAAIH,MACN,EAAKmC,UAAUlG,GACfkE,EAAIc,OAAOF,S,EAIfyB,aAAe,kBAAM,EAAKvF,MAAMgF,OAAOd,KAAI,gBAAGlF,EAAH,EAAGA,GAAIV,EAAP,EAAOA,IAAP,OACzC,yBACEyE,IAAK/D,EACLS,UAAU,eACV8E,QAAS,kBAAM,EAAKW,UAAUlG,IAC9BwG,UAAW,SAACtC,GAAD,OAAS,EAAKoC,eAAepC,EAAKlE,IAC7CyG,SAAS,KACT,kBAAC,EAAD,CAAK9F,IAAKrB,EAAKmB,UAAU,oBAAoBI,IAAI,U,EAIrD6F,YAAc,WAAO,IAAD,EACgB,EAAK1F,MAA/BiF,EADU,EACVA,YAAa1B,EADH,EACGA,SAErB,OAAK0B,EAIE,kBAAC,EAAD,CAAc1B,SAAUA,EAAUP,WAAY,EAAKA,aAHjD,M,mFA1CU,IAAD,OAClBxE,KAAK6D,eAAesD,eACjBlF,MAAK,SAAAuE,GACJ,EAAKtE,SAAS,CAAE8B,SAAS,EAAOwC,cAEjCrE,OAAM,WACL,EAAKD,SAAS,CAAE8B,SAAS,EAAOtC,OAAO,S,+BA2C3C,GAAI1B,KAAKwB,MAAMwC,QACb,OAAO,kBAAC,EAAD,MAGT,GAAIhE,KAAKwB,MAAME,MACb,OAAO,kBAAC,EAAD,MAGT,IAAM8E,EAASxG,KAAK+G,eACdK,EAAQpH,KAAKkH,cAEnB,OACE,yBAAKjG,UAAU,WACXuF,EACAY,O,GA7E2B9E,IAAMC,YCP5B8E,G,uLCMX,OACE,6BAASpG,UAAU,OAEjB,4BAAQA,UAAU,eAChB,wBAAIA,UAAU,cAAd,aAGF,yBAAKA,UAAU,aACb,kBAAC,EAAD,OAGF,4BAAQA,UAAU,eAChB,0BAAMA,UAAU,kBAAhB,wB,GAfuBqB,IAAMC,YCGvC+E,IAASC,OAAO,kBAAC,EAAD,MAAStB,SAASuB,eAAe,W","file":"static/js/main.dd2171d4.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/error.887a5f02.svg\";","module.exports = __webpack_public_path__ + \"static/media/loading.c0e8406b.svg\";","module.exports = __webpack_public_path__ + \"static/media/error.0edf97f1.svg\";","export default class GalleryService {\n  _apiBase = 'https://boiling-refuge-66454.herokuapp.com';\n\n  async getResource(url) {\n    const res = await fetch(`${this._apiBase}${url}`);\n\n    if (!res.ok) {\n      throw new Error(`Could not fetch ${url}, recieved ${res.status}`);\n    }\n\n    const body = await res.json();\n    return body;\n  }\n\n  async getAllImages() {\n    const res = await this.getResource('/images');\n    return await res;\n  }\n\n  async getImage(id) {\n    const res = await this.getResource(`/images/${id}`);\n    return await res;\n  }\n\n  async postComment(id, comment) {\n    const res = await fetch(`${this._apiBase}/images/${id}/comments`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json;charset=utf-8',\n      },\n      body: JSON.stringify(comment),\n    });\n\n    if (res.status !== 204) {\n      throw new Error(`Could not fetch, recieved ${res.status}`);\n    }\n\n    return Promise.resolve();\n  }\n}\n","import Spinner from './spinner';\n\nexport default Spinner;\n","import React from 'react';\n\nimport './spinner.css';\n\nconst Spinner = () => {\n  return (\n    <div className=\"spinner\">\n      <div className=\"spinner__inner\" />\n    </div>\n  );\n};\n\nexport default Spinner;\n","import ErrorIndicator from './error-indicator';\n\nexport default ErrorIndicator;\n","import React from 'react';\n\nimport image from './error.svg';\nimport './error-indicator.css';\n\nconst ErrorIndicator = () => {\n  return (\n    <div className=\"error\">\n      <img className=\"error__image\" src={image} alt=\"error\" />\n      <span className=\"error__text\">something has gone terribly wrong</span>\n      <a className=\"error__link\" href=\"/\">try starting over</a>\n    </div>\n  );\n};\n\nexport default ErrorIndicator;\n","import Img from './img';\n\nexport default Img;\n","import React from 'react';\n\nimport imgLoading from './loading.svg';\nimport imgError from './error.svg';\nimport './img.css';\n\nexport default class Img extends React.Component {\n  state = {\n    source: null,\n    error: false,\n  };\n\n  loadImage = (url) => {\n    return new Promise((resolve, reject) => {\n      const image = new Image();\n      image.onload = resolve;\n      image.onerror = reject;\n      image.src = url;\n    });\n  };\n\n  componentDidMount() {\n    const { src } = this.props;\n    this.loadImage(this.props.src)\n      .then(() => {\n        this.setState({ source: src });\n      })\n      .catch(() => {\n        this.setState({ error: true });\n      });\n  }\n\n  render() {\n    const { className, alt } = this.props;\n    const { source, error } = this.state;\n\n    if (error) {\n      return (\n        <div className=\"img\">\n          <img className=\"img_loader\" alt=\"\" src={imgError} />\n        </div>\n      );\n    }\n\n    if (!source) {\n      return (\n        <div className=\"img\">\n          <img className=\"img_loader\" alt=\"\" src={imgLoading} />\n        </div>\n      );\n    }\n\n    return <img src={source} className={className} alt={alt} />;\n  }\n}\n","import Input from './input';\n\nexport default Input;\n","import React from 'react';\nimport cn from 'classnames';\n\nimport './input.css';\n\nconst Input = ({name, value, onChange, placeholder, errorText = 'Заполните поле', isValid = true }) => {\n  const cls = cn({\n    'input': true,\n    'input_filled': value.length > 0,\n    'input_error': !isValid,\n  });\n  const placeholderText = isValid ? placeholder : errorText;\n\n  return (\n    <div className={cls}>\n      <input className=\"input__field\" type=\"text\" name={name} value={value} onChange={onChange}/>\n      <div className=\"input__placeholder\">{placeholderText}</div>\n    </div>\n  );\n};\n\nexport default Input;\n","export default () => Math.random().toString(32).substr(2, 12);\n","export default (timestamp) => {\n  return new Date(timestamp).toISOString()\n    .replace(/^([^T]+)T(.+)$/,'$1')\n    .replace(/^(\\d+)-(\\d+)-(\\d+)$/,'$3.$2.$1')\n};\n","import GalleryModal from './gallery-modal';\n\nexport default GalleryModal;\n","import React from 'react';\nimport FocusLock from \"react-focus-lock\";\n\nimport GalleryService from '../../service';\nimport Img from '../img';\nimport Spinner from '../spinner';\nimport ErrorIndicator from '../error-indicator';\nimport Input from '../input';\nimport { generateId, transformDate } from '../../utils';\nimport './gallery-modal.css';\n\nexport default class GalleryModal extends React.Component {\n  galleryService = new GalleryService();\n  buttonRef = React.createRef();\n\n  state = {\n    loading: true,\n    error: false,\n    url: '',\n    comments: [],\n    name: '',\n    text: '',\n    nameIsValid: true,\n    textIsValid: true,\n    submitBlocked: false,\n  };\n\n  componentDidMount() {\n    this.galleryService\n      .getImage(this.props.modalIdx)\n      .then(({ url, comments }) => {\n        this.setState({\n          url,\n          comments,\n          loading: false,\n        });\n      })\n      .catch(() => {\n        this.setState({\n          error: true,\n          loading: false,\n        });\n      });\n\n    // не нашел адекватного пути вешать обработку клавиши Escape :(\n    // если вешать onKeyDown на .gallery-modal - Escape не срабатывает, т.к. фокус уходит на body\n    // и приходится минимум 1 раз нажать tab для фокусировки внутри модалки\n    document.body.addEventListener('keydown', this.keyDownModal);\n  }\n\n  componentWillUnmount() {\n    document.body.removeEventListener('keydown', this.keyDownModal);\n  }\n\n  keyDownModal = ({ key }) => {\n    key === 'Escape' && this.props.closeModal();\n  };\n\n  validateForm() {\n    const { name, text } = this.state;\n    const nameIsEmpty = name.trim().length === 0;\n    const textIsEmpty = text.trim().length === 0;\n\n    this.setState({\n      nameIsValid: !nameIsEmpty,\n      textIsValid: !textIsEmpty,\n    });\n\n    if (nameIsEmpty || textIsEmpty) {\n      return false;\n    }\n\n    return true;\n  }\n\n  submitForm = (evt) => {\n    evt.preventDefault();\n\n    const formIsValid = this.validateForm();\n    if (!formIsValid) {\n      return ;\n    }\n\n    const { submitBlocked } = this.state;\n    if (submitBlocked) {\n      return ;\n    }\n\n    const text = this.state.text.trim();\n    const name = this.state.name.trim();\n    this.setState({ submitBlocked: true });\n    this.galleryService\n      .postComment(this.props.modalIdx, { name, comment: text })\n      .then(() => {\n        const { comments } = this.state;\n        const newComment = {\n          text,\n          name,\n          id: generateId(),\n          date: Date.now(),\n        };\n\n        this.setState({\n          name: '',\n          text: '',\n          nameIsValid: true,\n          textIsValid: true,\n          comments: comments.concat(newComment),\n          submitBlocked: false,\n        });\n      });\n\n    this.buttonRef.current.blur();\n  };\n\n  changeInput = (evt) => {\n    this.setState({ [evt.target.name]: evt.target.value });\n  };\n\n  renderComments = () => {\n    const { comments } = this.state;\n\n    if (comments.length === 0) {\n      return (\n        <div className=\"gallery-modal__comments-dummy\">\n          Здесь пока никто не написал... :(\n          <br />\n          Оставьте первый комментарий!\n        </div>\n      );\n    }\n\n    const renderedComments = comments.map(comment => {\n      const { id, date, text, name } = comment;\n      return (\n        <div key={id} className=\"gallery-modal__comment\">\n          <div className=\"gallery-modal__comment-info\">\n            <time className=\"gallery-modal__comment-date\">{transformDate(date)}</time>\n            <span className=\"gallery-modal__comment-user\">{name || 'User'}</span>\n          </div>\n          <p className=\"gallery-modal__comment-text\">{text}</p>\n        </div>\n      );\n    });\n\n    return renderedComments;\n  };\n\n  renderModalContent = () => {\n    if (this.state.loading) {\n      return <Spinner />;\n    }\n\n    if (this.state.error) {\n      return <ErrorIndicator />;\n    }\n\n    const { closeModal } = this.props;\n    const { url, name, text, nameIsValid, textIsValid } = this.state;\n    const comments = this.renderComments();\n\n    return (\n      <>\n        <div className=\"gallery-modal__image-container\">\n          <Img src={url} className=\"gallery-modal__image\" alt=\"\" />\n        </div>\n        <div className=\"gallery-modal__comments\">{comments}</div>\n        <form className=\"gallery-modal__form\" onSubmit={this.submitForm}>\n          <div className=\"gallery-modal__input\">\n            <Input name=\"name\"\n              value={name}\n              onChange={this.changeInput}\n              placeholder=\"Ваше имя\"\n              errorText=\"Введите ваше имя\"\n              isValid={nameIsValid} />\n          </div>\n          <div className=\"gallery-modal__input\">\n            <Input name=\"text\"\n              value={text}\n              onChange={this.changeInput}\n              placeholder=\"Ваш комментарий\"\n              errorText=\"Введите комментарий\"\n              isValid={textIsValid} />\n          </div>\n          <button className=\"gallery-modal__button\" ref={this.buttonRef}>Оставить комментарий</button>\n        <button className=\"gallery-modal__close\" onClick={closeModal}/>\n        </form>\n      </>\n    );\n  };\n\n  render() {\n    const { closeModal } = this.props;\n    const modalContent = this.renderModalContent();\n\n    return (\n      <FocusLock>\n        <div className=\"gallery-modal\">\n          <div className=\"gallery-modal__paranja\" onClick={closeModal}/>\n          <div className=\"gallery-modal__content\">\n            { modalContent }\n          </div>\n        </div>\n      </FocusLock>\n    );\n  }\n}\n","import Gallery from './gallery';\n\nexport default Gallery;\n","import React from 'react';\n\nimport GalleryService from '../../service';\nimport Spinner from '../spinner';\nimport ErrorIndicator from '../error-indicator';\nimport Img from '../img';\nimport GalleryModal from '../gallery-modal';\nimport './gallery.css';\n\nexport default class Gallery extends React.Component {\n\n  galleryService = new GalleryService();\n\n  state = {\n    loading: true,\n    error: false,\n    images: null,\n    modalOpened: false,\n    modalIdx: null,\n    name: '',\n    text: '',\n  };\n\n  componentDidMount() {\n    this.galleryService.getAllImages()\n      .then(images => {\n        this.setState({ loading: false, images });\n      })\n      .catch(() => {\n        this.setState({ loading: false, error: true });\n      });\n  }\n\n  openModal = (id) => {\n    document.body.classList.add('scroll-hidden');\n    this.setState({ modalOpened: true, modalIdx: id });\n  };\n\n  closeModal = () => {\n    document.body.classList.remove('scroll-hidden');\n    this.setState({ modalOpened: false, modalIdx: null });\n  };\n\n  keyDownGallery = (evt, id) => {\n    if (evt.key === 'Enter') {\n      this.openModal(id);\n      evt.target.blur();\n    }\n  };\n\n  renderImages = () => this.state.images.map(({ id, url }) => (\n    <div\n      key={id}\n      className=\"gallery-item\"\n      onClick={() => this.openModal(id)}\n      onKeyDown={(evt) => this.keyDownGallery(evt, id)}\n      tabIndex=\"0\">\n      <Img src={url} className=\"gallery-item__img\" alt=\"\" />\n    </div>\n  ));\n\n  renderModal = () => {\n    const { modalOpened, modalIdx } = this.state;\n\n    if (!modalOpened) {\n      return null;\n    }\n\n    return <GalleryModal modalIdx={modalIdx} closeModal={this.closeModal}/>;\n  }\n\n  render() {\n    if (this.state.loading) {\n      return <Spinner />;\n    }\n\n    if (this.state.error) {\n      return <ErrorIndicator />;\n    }\n\n    const images = this.renderImages();\n    const modal = this.renderModal();\n\n    return (\n      <div className=\"gallery\">\n        { images }\n        { modal }\n      </div>\n    );\n  }\n}\n","import App from './app';\n\nexport default App;\n","import React from 'react';\n\nimport Gallery from '../gallery';\nimport './app.css';\n\nexport default class App extends React.Component {\n\n  render() {\n    return (\n      <section className=\"app\">\n\n        <header className=\"app__header\">\n          <h1 className=\"app__title\">Test App</h1>\n        </header>\n\n        <div className=\"app__main\">\n          <Gallery />\n        </div>\n\n        <footer className=\"app__footer\">\n          <span className=\"app__copyright\">\n            &copy; 2018-2019\n          </span>\n        </footer>\n\n      </section>\n    );\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './normalize.css';\nimport './style.css';\n\nimport App from './components/app';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}