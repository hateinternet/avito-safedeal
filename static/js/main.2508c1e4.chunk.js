(this.webpackJsonpgallery=this.webpackJsonpgallery||[]).push([[0],[,,,,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/error.887a5f02.svg"},function(e,t,a){e.exports=a.p+"static/media/loading.c0e8406b.svg"},function(e,t,a){e.exports=a.p+"static/media/error.0edf97f1.svg"},,,,,function(e,t,a){e.exports=a(35)},,,,,function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(10),c=a.n(l),o=(a(23),a(24),a(2)),s=a(3),i=a(5),m=a(4),u=a(6),d=a(1),p=a.n(d),f=function(){function e(){Object(o.a)(this,e),this._apiBase="https://boiling-refuge-66454.herokuapp.com"}return Object(s.a)(e,[{key:"getResource",value:function(e){var t,a;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.a.awrap(fetch("".concat(this._apiBase).concat(e)));case 2:if((t=n.sent).ok){n.next=5;break}throw new Error("Could not fetch ".concat(e,", recieved ").concat(t.status));case 5:return n.next=7,p.a.awrap(t.json());case 7:return a=n.sent,n.abrupt("return",a);case 9:case"end":return n.stop()}}),null,this)}},{key:"getAllImages",value:function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.awrap(this.getResource("/images"));case 2:return e=t.sent,t.next=5,p.a.awrap(e);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),null,this)}},{key:"getImage",value:function(e){var t;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,p.a.awrap(this.getResource("/images/".concat(e)));case 2:return t=a.sent,a.next=5,p.a.awrap(t);case 5:return a.abrupt("return",a.sent);case 6:case"end":return a.stop()}}),null,this)}},{key:"postComment",value:function(e,t){var a;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.a.awrap(fetch("".concat(this._apiBase,"/images/").concat(e,"/comments"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(t)}));case 2:if(204===(a=n.sent).status){n.next=5;break}throw new Error("Could not fetch, recieved ".concat(a.status));case 5:return n.abrupt("return",Promise.resolve());case 6:case"end":return n.stop()}}),null,this)}}]),e}(),g=(a(26),function(){return r.a.createElement("div",{className:"spinner"},r.a.createElement("div",{className:"spinner__inner"}))}),h=a(11),v=a.n(h),y=(a(27),function(){return r.a.createElement("div",{className:"error"},r.a.createElement("img",{className:"error__image",src:v.a,alt:"error"}),r.a.createElement("span",{className:"error__text"},"something has gone terribly wrong"),r.a.createElement("a",{className:"error__link",href:"/"},"try starting over"))}),_=a(12),b=a.n(_),E=a(13),x=a.n(E),N=(a(28),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={source:null,error:!1},a.loadImage=function(e){return new Promise((function(t,a){var n=new Image;n.onload=t,n.onerror=a,n.src=e}))},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.src;this.loadImage(this.props.src).then((function(){e.setState({source:t})})).catch((function(){e.setState({error:!0})}))}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.alt,n=this.state,l=n.source;return n.error?r.a.createElement("div",{className:"img"},r.a.createElement("img",{className:"img_loader",alt:"",src:x.a})):l?r.a.createElement("img",{src:l,className:t,alt:a}):r.a.createElement("div",{className:"img"},r.a.createElement("img",{className:"img_loader",alt:"",src:b.a}))}}]),t}(r.a.Component)),k=a(7),w=a(15),I=a(14),O=a.n(I),j=(a(29),function(e){var t=e.name,a=e.value,n=e.onChange,l=e.placeholder,c=e.errorText,o=void 0===c?"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u043f\u043e\u043b\u0435":c,s=e.isValid,i=void 0===s||s,m=O()({input:!0,input_filled:a.length>0,input_error:!i}),u=i?l:o;return r.a.createElement("div",{className:m},r.a.createElement("input",{className:"input__field",type:"text",name:t,value:a,onChange:n}),r.a.createElement("div",{className:"input__placeholder"},u))}),S=function(){return Math.random().toString(32).substr(2,12)},C=function(e){return new Date(e).toLocaleDateString()},M=(a(30),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(l)))).galleryService=new f,a.buttonRef=r.a.createRef(),a.state={loading:!0,error:!1,url:"",comments:[],name:"",text:"",nameIsValid:!0,textIsValid:!0,submitBlocked:!1},a.keyDownModal=function(e){"Escape"===e.key&&a.props.closeModal()},a.submitForm=function(e){if((e.preventDefault(),a.validateForm())&&!a.state.submitBlocked){var t=a.state,n=t.text,r=t.name;a.setState({submitBlocked:!0}),a.galleryService.postComment(a.props.modalIdx,{name:r,comment:n}).then((function(){var e=a.state.comments,t={text:n,id:S(),date:Date.now()};a.setState({name:"",text:"",nameIsValid:!0,textIsValid:!0,comments:e.concat(t),submitBlocked:!1})})),a.buttonRef.current.blur()}},a.changeInput=function(e){a.setState(Object(k.a)({},e.target.name,e.target.value))},a.renderComments=function(){var e=a.state.comments;return 0===e.length?r.a.createElement("div",{className:"gallery-modal__comments-dummy"},"\u0417\u0434\u0435\u0441\u044c \u043f\u043e\u043a\u0430 \u043d\u0438\u043a\u0442\u043e \u043d\u0435 \u043d\u0430\u043f\u0438\u0441\u0430\u043b... :(",r.a.createElement("br",null),"\u041e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u043f\u0435\u0440\u0432\u044b\u0439 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439!"):e.map((function(e){var t=e.id,a=e.date,n=e.text;return r.a.createElement("div",{key:t,className:"gallery-modal__comment"},r.a.createElement("time",{className:"gallery-modal__comment-date"},C(a)),r.a.createElement("p",{className:"gallery-modal__comment-text"},n))}))},a.renderModalContent=function(){if(a.state.loading)return r.a.createElement(g,null);if(a.state.error)return r.a.createElement(y,null);var e=a.props.closeModal,t=a.state,n=t.url,l=t.name,c=t.text,o=t.nameIsValid,s=t.textIsValid,i=a.renderComments();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"gallery-modal__image-container"},r.a.createElement(N,{src:n,className:"gallery-modal__image",alt:""})),r.a.createElement("div",{className:"gallery-modal__comments"},i),r.a.createElement("form",{className:"gallery-modal__form",onSubmit:a.submitForm},r.a.createElement("div",{className:"gallery-modal__input"},r.a.createElement(j,{name:"name",value:l,onChange:a.changeInput,placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",errorText:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0438\u043c\u044f",isValid:o})),r.a.createElement("div",{className:"gallery-modal__input"},r.a.createElement(j,{name:"text",value:c,onChange:a.changeInput,placeholder:"\u0412\u0430\u0448 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",errorText:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",isValid:s})),r.a.createElement("button",{className:"gallery-modal__button",ref:a.buttonRef},"\u041e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"),r.a.createElement("button",{className:"gallery-modal__close",onClick:e})))},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.galleryService.getImage(this.props.modalIdx).then((function(t){var a=t.url,n=t.comments;e.setState({url:a,comments:n,loading:!1})})).catch((function(){e.setState({error:!0,loading:!1})})),document.body.addEventListener("keydown",this.keyDownModal)}},{key:"componentWillUnmount",value:function(){document.body.removeEventListener("keydown",this.keyDownModal)}},{key:"validateForm",value:function(){var e=this.state,t=e.name,a=e.text,n=0===t.trim().length,r=0===a.trim().length;return this.setState({nameIsValid:!n,textIsValid:!r}),!n&&!r}},{key:"render",value:function(){var e=this.props.closeModal,t=this.renderModalContent();return r.a.createElement(w.a,null,r.a.createElement("div",{className:"gallery-modal"},r.a.createElement("div",{className:"gallery-modal__paranja",onClick:e}),r.a.createElement("div",{className:"gallery-modal__content"},t)))}}]),t}(r.a.Component)),D=(a(33),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(l)))).galleryService=new f,a.state={loading:!0,error:!1,images:null,modalOpened:!1,modalIdx:null,name:"",text:""},a.openModal=function(e){document.body.classList.add("scroll-hidden"),a.setState({modalOpened:!0,modalIdx:e})},a.closeModal=function(){document.body.classList.remove("scroll-hidden"),a.setState({modalOpened:!1,modalIdx:null})},a.keyDownGallery=function(e,t){"Enter"===e.key&&(a.openModal(t),e.target.blur())},a.renderImages=function(){return a.state.images.map((function(e){var t=e.id,n=e.url;return r.a.createElement("div",{key:t,className:"gallery-item",onClick:function(){return a.openModal(t)},onKeyDown:function(e){return a.keyDownGallery(e,t)},tabIndex:"0"},r.a.createElement(N,{src:n,className:"gallery-item__img",alt:""}))}))},a.renderModal=function(){var e=a.state,t=e.modalOpened,n=e.modalIdx;return t?r.a.createElement(M,{modalIdx:n,closeModal:a.closeModal}):null},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.galleryService.getAllImages().then((function(t){e.setState({loading:!1,images:t})})).catch((function(){e.setState({loading:!1,error:!0})}))}},{key:"render",value:function(){if(this.state.loading)return r.a.createElement(g,null);if(this.state.error)return r.a.createElement(y,null);var e=this.renderImages(),t=this.renderModal();return r.a.createElement("div",{className:"gallery"},e,t)}}]),t}(r.a.Component)),V=(a(34),function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("section",{className:"app"},r.a.createElement("header",{className:"app__header"},r.a.createElement("h1",{className:"app__title"},"Test App")),r.a.createElement("div",{className:"app__main"},r.a.createElement(D,null)),r.a.createElement("footer",{className:"app__footer"},r.a.createElement("span",{className:"app__copyright"},"\xa9 2018-2019")))}}]),t}(r.a.Component));c.a.render(r.a.createElement(V,null),document.getElementById("root"))}],[[18,1,2]]]);
//# sourceMappingURL=main.2508c1e4.chunk.js.map